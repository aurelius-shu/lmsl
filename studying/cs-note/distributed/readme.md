# 分布式

## 分布式锁(互斥)

实现不同节点上进程的同步(互斥)，一般通过`互斥量`实现

### 实现方法

1. 数据库唯一索引
2. Redis 命令 setnx
3. Redis RedLock 算法
4. Zookeeper 有序临时节点 + 监听器(监听前一个节点)

## 分布式事务(ACID)

### 2PC

1. 准备阶段
   (协调者)投票 -> (参与者)执行&返回结果
2. 提交阶段
   (协调者)提交/回滚 -> (参与者)执行提交/回滚

### 本地消息表

## CAP

### 一致性(Consistency)

执行一次更新之后，如果所有用户都能读取到最新值，则该系统具有`强一致性`

### 可用性(Availability)

用户的每一次请求总是可以在有限时间返回结果

### 分区容忍性(Partion Tolerance)

发生网络分区故障时，仍然能对外提供一致性与可用性的服务

## BASE

### 基本可用(Basically Available)

保证核心可用，允许损失部分可用性，部分请求降级处理

### 软状态(Soft State)

允许存在中间状态，不同节点的数据副本同步存在延时

### 最终一致性(Eventually Consistent)

所有数据副本，在经过一段时间的同步后，能达到一致的状态

## Paxos

### 执行过程

1. Prepare
2. Accept
3. Learn

## Raft

1. 选举
2. 数据同步
